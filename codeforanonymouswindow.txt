string s1 = '<?xml version="1.0" encoding="UTF-8"?> <Package xmlns="http://soap.sforce.com/2006/04/metadata"> <types> <members>ArticleExtension</members> <members>ArticleExtensionTest</members> <members>ArticleFeedbackController</members> <members>Attachment_Controller</members> <members>Attachment_Controller_Test</members> <members>B2B_NAP_RepairProcess</members> <members>BillingCustomerservice</members> <members>BillingCustomerServiceESB_WSDL</members> <members>BillingCustomerServiceESB_WSDL_Test</members> <members>CaseManagementAPI</members> <members>CaseManagementAPIRequestHandler</members> <members>CaseManagementAPIRestWrapper</members> <members>CaseManagementAPIWrapper</members> <members>CommonQuickCaseInterface</members> <members>Common_AccountAccessor</members> <members>Common_AccountHistoryConstants</members> <members>Common_AccountHistoryPageInitializer</members> <members>Common_AccountTransactionAccessor</members> <members>Common_AccountTransactionHistoryService</members> <members>Common_ActivityTypeAccessor</members> <members>Common_AES128EncryptionService</members> <members>Common_AssetAccessor</members> <members>Common_AssetAttributesService</members> <members>Common_AttributeAuditsService</members> <members>Common_BillingSummaryConstants</members> <members>Common_BillingSummaryHelper</members> <members>Common_CaseAccessor</members> <members>Common_CaseMilestoneAccessor</members> <members>Common_CaseService</members> <members>Common_CaseTemplateExtension</members> <members>Common_CaseTemplateViewModel</members> <members>Common_CLOOrderDataParams</members> <members>Common_ContactAccessor</members> <members>Common_Continuation4Odata</members> <members>Common_CRActualIssueActionExtension</members> <members>Common_CustomLabelCSettingUtility</members> <members>Common_CustomPicklistScriptController</members> <members>Common_DataTableSchema</members> <members>Common_EntitlementAccessor</members> <members>Common_ExceptionLogUtility</members> <members>Common_FAPManagmentController</members> <members>Common_FAPManagmentController_Test</members> <members>Common_FAPManagmentProcessorMock</members> <members>Common_FeatureNServiceOfferingsService</members> <members>Common_FieldMappingAccessor</members> <members>Common_FieldMappingUtility</members> <members>Common_FSOHistoryService</members> <members>Common_IDataAdminViewModel</members> <members>Common_IDelegateConstructor</members> <members>Common_IntegrationLogUtility</members> <members>Common_InternationalRWOProcessHelper</members> <members>Common_IRepairWorkOrder</members> <members>Common_OrderParamsService</members> <members>Common_ParameterProcessInterface</members> <members>Common_Parameters</members> <members>Common_QueryAPIValidator_Mock</members> <members>Common_QueryCaseApi_Test</members> <members>Common_QuickCaseCreateController</members> <members>Common_QuickCaseCreateService</members> <members>Common_QuickCaseFactory</members> <members>Common_QuickCaseInterface</members> <members>Common_RecommendedNextStepMappingUtility</members> <members>Common_RedTextMesageInlinePageController</members> <members>Common_RedText_Interface</members> <members>Common_RegistrationParamsService</members> <members>Common_RepairOrderWSUtility</members> <members>Common_RepairProcessValidationsHelper</members> <members>Common_RepairWorkOrderDeterminant</members> <members>Common_RepairWorkOrderFactory</members> <members>Common_RepairWorkOrderProcess</members> <members>Common_RepairWorkOrderProcessHelper</members> <members>Common_RIACustomPicklistUtility</members> <members>Common_RIAPriorityViewModel</members> <members>Common_RMAHistoryService</members> <members>Common_SchemaUtility</members> <members>Common_ServiceProviderRuleAccessor</members> <members>Common_SFDCIBPicklistMappingUtility</members> <members>Common_SiteTransactionsService</members> <members>Common_SpecialInstructionAccessor</members> <members>Common_SpecialInstructionAnalyzer</members> <members>Common_SpecialInstructionsExtension</members> <members>Common_SpecialInstructionViewModel</members> <members>Common_SplInstProcessor</members> <members>Common_State_ExitCode</members> <members>Common_StaticConstants</members> <members>Common_TabLinkVisibilityUtility</members> <members>Common_TemplateAccessor</members> <members>Common_TestDataUtility</members> <members>Common_TimeZoneAccessor</members> <members>Common_TimeZoneCorrectionUtility</members> <members>Common_URLMappingUtility</members> <members>Common_UserDateFormatUtility</members> <members>Common_UserDefinedTemplateController</members> <members>Common_UserDefinedTemplateControllerTest</members> <members>Common_Utility</members> <members>Common_Utility_Test</members> <members>Common_VideoOptimisationClient</members> <members>Common_VideoOptimisationRequestBuilder</members> <members>Common_VideoOptimisationResponseHandler</members> <members>Common_VideoOptmizeService</members> <members>Common_VideoOptProcessor</members> <members>Common_VideoOpt_Interface</members> <members>Common_VideoSettingComponentController</members> <members>CustomPermissionsReader</members> <members>CustomPermissionsReaderTest</members> <members>DynamicComponentClass</members> <members>DynamicComponentClass_Test</members> <members>HSvc_AccountHistoryDTO</members> <members>HSvc_AccountInfoDTO</members> <members>HSvc_AccountUpdInfoDTO</members> <members>HSvc_ApexPageException</members> <members>HSvc_AssetDto</members> <members>HSvc_AssociationBITriggerHandler</members> <members>HSvc_AssociationBUTriggerHandler</members> <members>Hsvc_AssociationMasterTriggerDispatcher</members> <members>Hsvc_AssociationTriggerHelper</members> <members>HSvc_AsyncBillingAPI</members> <members>HSvc_BillingAPI</members> <members>HSvc_BillingInfoDTO</members> <members>HSvc_BillingSummaryAccessor</members> <members>HSvc_BillingSummaryClient</members> <members>HSvc_BillingSummaryCodeFormatter</members> <members>Hsvc_BillingSummaryController</members> <members>HSvc_BillingSummaryRequestBuilder</members> <members>Hsvc_BrazilChangeDueDatePermDTO</members> <members>Hsvc_Cancel_Integerationlog_Util</members> <members>HSvc_Cancel_RepairWorkOrder_ClientClass</members> <members>HSvc_Cancel_RepairWorkOrder_ReqBuilder</members> <members>HSvc_CaseDto</members> <members>HSvc_ChangeDueDayDTO</members> <members>Hsvc_creditNoteInfoDTO</members> <members>HSvc_CustomPicklistDTO</members> <members>Hsvc_DataCategoryGroupInfo</members> <members>Hsvc_DataCategoryGroupInfoTestClass</members> <members>Hsvc_DataCategoryInfo</members> <members>Hsvc_DataCategoryInfoTestClass</members> <members>Hsvc_DataCategoryUtil</members> <members>Hsvc_DataCategoryUtilTestClass</members> <members>HSvc_DelinquencyDatesDTO</members> <members>HSvc_ExemptCollectionMessageRequestDTO</members> <members>Hsvc_KnowledgeController</members> <members>Hsvc_KnowledgeControllerTestClass</members> <members>Hsvc_KnowledgeController_Test</members> <members>hsvc_limit_utility</members> <members>HSvc_MetadataService</members> <members>HSvc_NAP_MilestoneTimeCalculator</members> <members>HSvc_OdataPaginationService</members> <members>HSvc_PicklistMasterBITriggerHandler</members> <members>HSvc_PicklistMasterBUTriggerHandler</members> <members>Hsvc_PicklistMasterTriggerDispatcher</members> <members>HSvc_PicklistMasterTriggerHelper</members> <members>HSvc_ProviderGroupAccessor</members> <members>HSvc_ProviderGroupFlowController</members> <members>HSvc_ReissueInvoiceDTO</members> <members>HSvc_RepairOrder_ClientClass</members> <members>HSvc_RepairOrder_RequestBuilder</members> <members>HSvc_RepairOrder_ResponseHandler</members> <members>HSvc_RepairOrder_ResponseParameters</members> <members>HSvc_RetentionServiceRequest</members> <members>HSvc_RetentionUnSuccessfulRequest</members> <members>HSvc_RIAReasonMappingAccessor</members> <members>HSvc_SelectedProviderGroupAccessor</members> <members>HSvc_SpecialInstructionsDto</members> <members>HSvc_State_KBExitCodeAccessor</members> <members>HSvc_SwitchPaymentTypeDTO</members> <members>Hsvc_UpdateStaticPicklistBatch</members> <members>Hsvc_UpdateStaticPicklistController</members> <members>Hsvc_UpdateStaticPicklistSch</members> <members>HSvc_UserAITriggerHandler</members> <members>HSvc_UserAUTriggerHandler</members> <members>HSvc_UserTriggerHelp</members> <members>HSvc_WWTSCaseMilestoneRule</members> <members>HSvc_WWTSServiceMaintenanceRuleAccessor</members> <members>HughesSvc_CSRToolsController</members> <members>HughesSvc_ExternalInterfaceService</members> <members>HughesSvc_HughesEncryption</members> <members>HughesSvc_RedirectController</members> <members>IAdditionalLogicHandler</members> <members>ILiveAgent</members> <members>IProcessFAPManagement</members> <members>ITransform</members> <members>ITriggerDispatcher</members> <members>ITriggerHandler</members> <members>IValidator</members> <members>liveagent_app_controller</members> <members>liveagent_prechat_controller</members> <members>liveagent_selfcare</members> <members>MultiselectController</members> <members>MultiselectControllerTest</members> <members>SA_B2B_HTR_RepairProcess</members> <members>SA_B2B_VM_RepairProcess</members> <members>SA_B2C_HTR_RepairProcess</members> <members>SearchManagementAPIRestWrapper</members> <members>TriggerDispatcherBase</members> <members>TriggerException</members> <members>TriggerFactory</members> <members>TriggerHandlerBase</members> <members>TriggerParameters</members> <members>UserTriggerDispatcher</members> <members>UtilityClass</members> <members>UtilsCustomSetting</members> <members>UtilsDeeperClone</members> <members>UtilsDeeperClone_Test</members> <members>UtilsGeneral</members> <members>UtilsVariables</members> <members>VideoOptimizeConstants</members> <members>VideoOptimizeRequestDTO</members> <members>WebServiceMockImpl</members> <members>YAHS_AccountTransIntTest</members> <members>YAHS_AES128EncryptionService</members> <name>ApexClass</name> </types> <version>42.0</version> </Package>';
String s2 =  '<?xml version="1.0" encoding="UTF-8"?> <Package xmlns="http://soap.sforce.com/2006/04/metadata"> <types> <members>CP_CasePrefHandlerTest</members> <members>CP_communicationPrefHandlerTest</members> <members>CP_communicationPrefTest</members> <members>CP_EmailComponentCtrlTest</members> <members>CP_Service_Activation_CO_ContTest</members> <members>CP_CommunicationPrefServiceTest</members> <members>HSvc_DateTimeService</members> <members>CP_SelfRegSendEmailBatchTest</members> <members>HughesSvc_CSRToolsController_test</members> <members>HSvc_AccountAccessor</members> <members>HughesSvc_Utility</members> <members>HSvc_CaseAccessor</members> <members>Case_CountrySpecificPageController</members> <members>Account_CountrySpecificPageController</members> <members>HSvc_QuickCaseCreateService</members> <members>HSvc_CaseCreateEditExtension</members> <members>HSvc_CaseCreateEditExtensionHelper</members> <members>HSvc_CaseCreateEditComponentController</members> <members>Common_CountrySpecificComponentCtrlTest</members> <members>Common_CountrySpecificComponentCtrl</members> <members>Account_CountrySpecificPageCtrlTest</members> <members>Case_CountrySpecificPageControllerTest</members> <members>HSvc_RepairOrder_RequestBuilder</members> <members>HSvc_AssetService</members> <members>HSvc_AssetAccessor</members> <members>HSvc_AssetHierarchyComponentController</members> <members>HSvc_UIFieldHandler</members> <name>ApexClass</name> </types> <types> <members>Account</members> <members>CP_Templates__c</members> <members>HSvc_CaseTemplate__c</members> <members>Hsvc_ActivityType__c</members> <members>HSvc_ResolutionCodeRule__c</members> <members>HSvc_AccountTransactionCodeMaster__c</members> <members>HSvc_AccTrxnReason__c</members> <members>HSvc_LabelValue__c</members> <members>Case</members> <members>HSvc_User_Queues__c</members> <members>Common_Field_To_Label_Mapping__c</members> <name>CustomObject</name> </types> <types> <members>Account-es_PA</members> <members>Asset-es_PA</members> <members>Case-es_PA</members> <members>CP_Templates__c-es_PA</members> <members>HnsCompLocBcAttachVws__x-es_PA</members> <members>HnsCompLocCaseVws__x-es_PA</members> <members>HnsCompLocRcAttachVws__x-es_PA</members> <members>HnsOrderedParas__x-es_PA</members> <members>HnsPsZsfFsoOdataViews__x-es_PA</members> <members>HnsRegistrationParas__x-es_PA</members> <members>HnsRmaOdataViews__x-es_PA</members> <members>HnsServiceOfferingss__x-es_PA</members> <members>HnsSiteAccountTranss__x-es_PA</members> <members>HnsSiteAttributeAudits__x-es_PA</members> <members>HnsSiteAttributess__x-es_PA</members> <members>HnsSiteAudits__x-es_PA</members> <members>HnsSiteCrossPolls__x-es_PA</members> <members>HnsSiteErrorTranss__x-es_PA</members> <members>HnsSiteTranss__x-es_PA</members> <members>HSvc_AccountTransactionCodeMaster__c-es_PA</members> <members>HSvc_AccountTransaction__c-es_PA</members> <members>HSvc_AccTrxnReason__c-es_PA</members> <members>HSvc_AccTrxnToHNSProduct__c-es_PA</members> <members>HSvc_AccTrxnToProviderGroup__c-es_PA</members> <members>Hsvc_ActivityType__c-es_PA</members> <members>Hsvc_CaseActivity__c-es_PA</members> <members>HSvc_CaseTemplate__c-es_PA</members> <members>Hsvc_FAPTokenTransaction__c-es_PA</members> <members>HSvc_KB_Exit_Code__c-es_PA</members> <members>HSvc_LabelValue__c-es_PA</members> <members>HSVC_Limit_Config__c-es_PA</members> <members>HSVC_Limit_Usage__c-es_PA</members> <members>HSvc_ProviderGroupTokens__c-es_PA</members> <members>HSvc_Provider_Group_FAP__c-es_PA</members> <members>HSvc_QuickNotesTemplates__c-es_PA</members> <members>HSvc_ResolutionCodeRule__c-es_PA</members> <members>HSvc_SpecialInstructions__c-es_PA</members> <members>HSvc_State_Code__c-es_PA</members> <members>HSvc_UserCredentials__c-es_PA</members> <members>HSvc_User_FAP__c-es_PA</members> <members>Knowledge__kav-es_PA</members> <members>HSvc_RIA_Reason_Mapping__c-es_PA</members> <members>Hsvc_VideoDataSaveTransactions__c-es_PA</members> <members>Asset-es_PA</members> <name>CustomObjectTranslation</name> </types> <types> <members>es_PA</members> <name>Translations</name> </types> <types> <members>Hsvc_ActivityType__c-Activity Type Layout</members> <members>HSvc_ResolutionCodeRule__c-HSvc_ResolutionCodeRule Layout</members> <members>HSvc_AccountTransactionCodeMaster__c-Account Transaction Code Master Layout</members> <members>HSvc_AccTrxnReason__c-Account Transaction Reason Layout</members> <members>HSvc_LabelValue__c-Label Vaue Layout</members> <members>Account-Brazil Consumer Customer Layout</members> <members>Account-Brazil Location Layout</members> <members>Account-Brazil-SOHO Layout</members> <members>Case-HSvc_CaseDetailLayout</members> <name>Layout</name> </types> <types> <members>INT CSR</members> <members>INT CSM</members> <members>INT Admin Plus</members> <members>Admin</members> <name>Profile</name> </types> <types> <members>CaseOrigin-es_PA</members> <members>CasePriority-es_PA</members> <members>CaseStatus-es_PA</members> <members>CaseType-es_PA</members> <members>AssetStatus-es_PA</members> <name>StandardValueSetTranslation</name> </types> <types> <members>HSvc_CaseCreateEdit</members> <members>Case_CountrySpecificPage</members> <members>Account_CountrySpecificPage</members> <name>ApexPage</name> </types> <types> <members>HSvc_Panama_Enterprise_Group</members> <members>HSvc_Panama_Retail_Group</members> <name>Group</name> </types> <types> <members>Account</members> <name>SharingRules</name> </types> <types> <members>HughesSvc_Reports/HSvc_AccountWorkOrders</members> <members>HughesSvc_Reports/HSvc_CaseHandleTimeSummary</members> <members>HughesSvc_Reports/HughesSvc_Activity_Summary</members> <members>HughesSvc_Reports/HughesSvc_CaseActivities</members> <name>Report</name> </types> <types> <members>Generate_CUN_ID</members> <members>Update_Case_Dates</members> <members>HSvc_ProviderGroupSelection</members> <name>FlowDefinition</name> </types> <types> <members>HSvc_AssetHierarchyComponent</members> <members>Common_CountrySpecificComponent</members> <members>HSvc_B2BGeneralCaseCreate</members> <members>HSvc_B2CGeneralCaseCreate</members> <members>HSvc_B2BB2CGeneralCaseEdit</members> <members>HSvc_RepairWorkOrder</members> <members>HSvc_RepairWorkOrderEdit</members> <members>HSvc_InstallWorkOrder</members> <members>HSvc_RMA</members> <members>HSvc_OfficeOnly</members> <name>ApexComponent</name> </types> <types> <members>*</members> <name>CustomLabels</name> </types> <types> <members>YAHS_Detail_Page_Setting.Common_CaseDetail_CaseSummaryInfo</members> <members>YAHS_Detail_Page_Setting.Common_CaseDetail_SLA</members> <members>YAHS_Detail_Page_Setting.Common_ConsumerAccount_AccountInfo</members> <members>YAHS_Detail_Page_Setting.Common_PartnerAccount_AccountInfo</members> <members>YAHS_Detail_Page_Setting.Common_LocationAccount_CommInfo</members> <members>YAHS_Detail_Page_Setting.Common_CaseDetail_Activity</members> <name>CustomMetadata</name> </types> <version>42.0</version> </Package>';
string s3 = s1.trim();
string s4 = s2.trim();
s3 = s3.replaceAll('(\\s+)', '');
s4 = s4.replaceAll('(\\s+)', '');
s3 = s3.replaceAll('</types>', '</types>;');
s4 = s4.replaceAll('</types>', '</types>;');
s3 = s3.remove('<?xmlversion="1.0"encoding="UTF-8"?><Packagexmlns="http://soap.sforce.com/2006/04/metadata">');
s3 = s3.remove('<version>42.0</version></Package>');
s4 = s4.remove('<?xmlversion="1.0"encoding="UTF-8"?><Packagexmlns="http://soap.sforce.com/2006/04/metadata">');
s4 = s4.remove('<version>42.0</version></Package>');
list<String> types = new list<string>();
list<String> types2 = new list<string>();
types = s3.split(';');
types2 = s4.split(';');
system.debug('types'+ types);
system.debug('types2'+ types2);
map<string, list<string>> listOfFilesByType = new map<string, list<string>>();
map<string, list<string>> listOfFilesByType2 = new map<string, list<string>>();
for(string st1 : types){
    system.debug('st1'+ st1);
    string metaType = st1.substringBetween('<name>','</name>');
    system.debug('metaType'+ metaType);
    st1 = st1.replaceAll('</members>', '</members>;');
    system.debug('st1'+ st1);
    List<string> removables = new list<string>{'<name>','</name>',metaType,'<members>', '</members>',  '<types>', '</types>'};
        for(string rem : removables){
            st1 = st1.remove(rem);
        }
    system.debug('st1'+ st1);
    list<string> files = st1.split(';');
    system.debug('files'+ files);
    listOfFilesByType.put(metaType,files);
}
for(string st1 : types2){
    system.debug('st1'+ st1);
    string metaType = st1.substringBetween('<name>','</name>');
    system.debug('metaType'+ metaType);
    st1 = st1.replaceAll('</members>', '</members>;');
    system.debug('st1'+ st1);
    List<string> removables = new list<string>{'<name>','</name>',metaType,'<members>', '</members>',  '<types>', '</types>'};
        for(string rem : removables){
            st1 = st1.remove(rem);
        }
    system.debug('st1'+ st1);
    list<string> files = st1.split(';');
    system.debug('files'+ files);
    listOfFilesByType2.put(metaType,files);
}
map<string, list<string>>totalmap = new map<string, list<string>>();
totalmap.putall(listOfFilesByType);
set<string> finalset = new set<string>();
list<string> finallist = new list<string>();
for(string key : listOfFilesByType2.keyset()){
    if(!totalmap.containskey(key)){
        totalmap.put(key, listOfFilesByType2.get(key));
    }
    else{
        finalset.addAll(totalmap.get(key));
        finalset.addAll(listOfFilesByType2.get(key));
        finallist.addAll(finalset);
        totalmap.put(key, finallist);
    }
}
system.debug('totalmap'+ totalmap);
string finalstring = '<?xml version="1.0" encoding="UTF-8"?><Package xmlns="http://soap.sforce.com/2006/04/metadata">';
for(string key : totalmap.keyset()){
    system.debug('key'+ key);
    finalstring = finalstring + '<types>';
    for(string val : totalmap.get(key)){
        system.debug('val'+ val);
        finalstring = finalstring + '<members>'+val+ '</members>';
    }
    system.debug('finalstring1'+ finalstring);
    finalstring = finalstring + '<name>'+key+'</name></types>';
    
    system.debug('finalstring2'+ finalstring);
}
finalstring = finalstring+'<version>40.0</version></Package>';
system.debug('finalstring'+ finalstring);
